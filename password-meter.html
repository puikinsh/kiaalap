{{> head}}

<style>
/* Critical CSS for immediate render */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #f5f7fa; }
        .sidebar { position: fixed; left: 0; top: 0; width: 260px; height: 100vh; background: #1f2937; z-index: 1040; }
        .main-wrapper { margin-left: 260px; min-height: 100vh; transition: margin-left 0.3s ease; }
        .top-navbar { background: white; height: 60px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); padding: 0 1rem; }
        .dashboard-content { padding: 24px; }

        /* Loading animation */
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .loading { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; background: #e5e7eb; }
</style>

{{> sidebar}}

<!-- Main Content Wrapper -->
<div class="main-wrapper" id="mainWrapper">
    {{> header}}

    <!-- Main Content -->
    <main class="dashboard-content" id="main-content">
        <div class="container-fluid">
<!-- Page Header -->
            <div class="mb-3">
                <h1 class="h3 font-bold">Password Meter</h1>
                <p class="text-muted text-sm">Advanced password strength validation and security tools</p>
            </div>

            <!-- Password Strength Meter Row -->
            <div class="dashboard-row">
                <div class="dashboard-grid grid-cols-2">
                    <!-- Password Strength Test -->
                    <div class="stats-card">
                        <div class="stats-card-label">Password Strength Analyzer</div>
                        <div class="mb-3">
                            <label for="passwordTest" class="form-label">Enter Password</label>
                            <div class="password-input-wrapper">
                                <input type="password" class="form-control" id="passwordTest" placeholder="Type your password...">
                                <button type="button" class="password-toggle" id="passwordToggle">
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                        </div>
                        <div class="password-strength-meter mb-3">
                            <div class="strength-label-row">
                                <span class="strength-label">Strength:</span>
                                <span class="strength-text" id="strengthText">Enter a password</span>
                            </div>
                            <div class="strength-bar-container">
                                <div class="strength-bar" id="strengthBar"></div>
                            </div>
                        </div>
                        <div class="d-flex justify-content-between">
                            <div class="metric-small">
                                <div class="metric-value-sm" id="passwordScore">0</div>
                                <div class="metric-label-sm">Score</div>
                            </div>
                            <div class="metric-small">
                                <div class="metric-value-sm" id="passwordLength">0</div>
                                <div class="metric-label-sm">Length</div>
                            </div>
                        </div>
                    </div>

                    <!-- Password Requirements -->
                    <div class="stats-card">
                        <div class="stats-card-label">Security Requirements</div>
                        <div class="requirements-list">
                            <div class="requirement-item" id="req-length">
                                <i class="bi bi-circle requirement-icon"></i>
                                <span>At least 8 characters</span>
                            </div>
                            <div class="requirement-item" id="req-uppercase">
                                <i class="bi bi-circle requirement-icon"></i>
                                <span>Uppercase letter (A-Z)</span>
                            </div>
                            <div class="requirement-item" id="req-lowercase">
                                <i class="bi bi-circle requirement-icon"></i>
                                <span>Lowercase letter (a-z)</span>
                            </div>
                            <div class="requirement-item" id="req-number">
                                <i class="bi bi-circle requirement-icon"></i>
                                <span>Number (0-9)</span>
                            </div>
                            <div class="requirement-item" id="req-special">
                                <i class="bi bi-circle requirement-icon"></i>
                                <span>Special character (!@#$%)</span>
                            </div>
                        </div>
                        <div class="requirements-status mt-3">
                            <div class="status-indicator" id="requirementsStatus">
                                <i class="bi bi-info-circle"></i>
                                <span>Enter a password to check</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Password Generator Row -->
            <div class="dashboard-row">
                <div class="dashboard-grid grid-cols-3" style="grid-template-columns: 2fr 1fr;">
                    <!-- Password Generator -->
                    <div class="chart-wrapper">
                        <div class="dashboard-card-header">
                            <h5 class="dashboard-card-title">Password Generator</h5>
                        </div>
                        <div class="dashboard-card-body">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="passwordLength" class="form-label">Length</label>
                                    <div class="d-flex align-items-center gap-2">
                                        <input type="range" class="form-range" id="passwordLength" min="8" max="64" value="16">
                                        <span class="length-display" id="lengthDisplay">16</span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="generator-options">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="includeUppercase" checked>
                                            <label class="form-check-label" for="includeUppercase">Uppercase</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="includeLowercase" checked>
                                            <label class="form-check-label" for="includeLowercase">Lowercase</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="includeNumbers" checked>
                                            <label class="form-check-label" for="includeNumbers">Numbers</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="includeSymbols" checked>
                                            <label class="form-check-label" for="includeSymbols">Symbols</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-primary mb-3" id="generatePassword">
                                <i class="bi bi-arrow-clockwise me-2"></i>Generate Password
                            </button>
                            <div class="input-group">
                                <input type="text" class="form-control font-monospace" id="generatedPassword" readonly placeholder="Generated password will appear here">
                                <button class="btn btn-outline-secondary" type="button" id="copyPassword">
                                    <i class="bi bi-clipboard"></i>
                                </button>
                            </div>
                            <small class="text-muted mt-2 d-block" id="generatedStrength">Click generate to see strength</small>
                        </div>
                    </div>

                    <!-- Security Tips -->
                    <div style="display: flex; flex-direction: column; gap: 24px;">
                        <div class="stats-card">
                            <div class="stats-card-label text-success">Password Best Practices</div>
                            <ul class="tip-list small">
                                <li>Use at least 12 characters</li>
                                <li>Mix letters, numbers, symbols</li>
                                <li>Avoid personal information</li>
                                <li>Use unique passwords per site</li>
                                <li>Consider a password manager</li>
                            </ul>
                        </div>

                        <div class="stats-card">
                            <div class="stats-card-label text-warning">Common Mistakes</div>
                            <div class="pattern-examples">
                                <div class="pattern-example small mb-2">
                                    <div class="pattern-bad">password123</div>
                                    <small class="text-muted">Dictionary + numbers</small>
                                </div>
                                <div class="pattern-example small mb-2">
                                    <div class="pattern-bad">qwerty</div>
                                    <small class="text-muted">Keyboard patterns</small>
                                </div>
                                <div class="pattern-example small">
                                    <div class="pattern-bad">john1990</div>
                                    <small class="text-muted">Name + birth year</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Password Comparison Row -->
            <div class="dashboard-grid grid-cols-2">
                <div class="dashboard-card">
                    <div class="dashboard-card-header">
                        <h5 class="dashboard-card-title">Password Comparison</h5>
                    </div>
                    <div class="dashboard-card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <label for="comparePassword1" class="form-label">Password A</label>
                                <div class="password-input-wrapper">
                                    <input type="password" class="form-control" id="comparePassword1" placeholder="First password">
                                    <button type="button" class="password-toggle" id="compareToggle1">
                                        <i class="bi bi-eye"></i>
                                    </button>
                                </div>
                                <div class="comparison-result mt-2" id="compareResult1">
                                    <div class="strength-indicator"></div>
                                    <small class="strength-details"></small>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="comparePassword2" class="form-label">Password B</label>
                                <div class="password-input-wrapper">
                                    <input type="password" class="form-control" id="comparePassword2" placeholder="Second password">
                                    <button type="button" class="password-toggle" id="compareToggle2">
                                        <i class="bi bi-eye"></i>
                                    </button>
                                </div>
                                <div class="comparison-result mt-2" id="compareResult2">
                                    <div class="strength-indicator"></div>
                                    <small class="strength-details"></small>
                                </div>
                            </div>
                        </div>
                        <div class="comparison-summary mt-3" id="comparisonSummary">
                            <div class="alert alert-info">
                                <i class="bi bi-info-circle me-2"></i>
                                Enter passwords in both fields to compare
                            </div>
                        </div>
                    </div>
                </div>

                <div class="dashboard-card">
                    <div class="dashboard-card-header">
                        <h5 class="dashboard-card-title">Security Analysis</h5>
                    </div>
                    <div class="dashboard-card-body">
                        <div class="security-metrics">
                            <div class="metric-row">
                                <div class="metric-item">
                                    <div class="metric-value" id="entropyValue">0</div>
                                    <div class="metric-label">Entropy (bits)</div>
                                </div>
                                <div class="metric-item">
                                    <div class="metric-value" id="crackTime">0s</div>
                                    <div class="metric-label">Crack Time</div>
                                </div>
                            </div>
                            <div class="security-recommendations mt-3" id="securityRecommendations">
                                <div class="alert alert-info">
                                    <i class="bi bi-lightbulb me-2"></i>
                                    Enter a password to see security analysis
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>        </div>
    </main>

    {{> footer}}
</div>

{{> scripts}}

<script>
document.addEventListener('DOMContentLoaded', function() {
        // Common passwords for checking
        const commonPasswords = [
            'password', '123456', 'password123', 'admin', 'qwerty', 'letmein',
            'welcome', 'monkey', '1234567890', 'dragon', 'princess', 'iloveyou'
        ];

        // Password strength calculation
        function calculatePasswordStrength(password) {
            let score = 0;
            let feedback = [];

            if (password.length === 0) {
                return { score: 0, level: 'none', text: 'Enter a password', feedback: [] };
            }

            // Length scoring
            if (password.length >= 8) score += 20;
            if (password.length >= 12) score += 10;
            if (password.length >= 16) score += 10;

            // Character variety scoring
            if (/[a-z]/.test(password)) score += 10;
            if (/[A-Z]/.test(password)) score += 10;
            if (/[0-9]/.test(password)) score += 10;
            if (/[^A-Za-z0-9]/.test(password)) score += 15;

            // Pattern penalties
            if (/(.)\1{2,}/.test(password)) score -= 10;
            if (/123|abc|qwe|asd|zxc/i.test(password)) score -= 15;

            // Common password check
            if (commonPasswords.includes(password.toLowerCase())) {
                score -= 25;
                feedback.push('Avoid common passwords');
            }

            // Determine strength level
            let level, text;
            if (score < 30) {
                level = 'very-weak';
                text = 'Very Weak';
            } else if (score < 50) {
                level = 'weak';
                text = 'Weak';
            } else if (score < 70) {
                level = 'medium';
                text = 'Medium';
            } else if (score < 90) {
                level = 'strong';
                text = 'Strong';
            } else {
                level = 'very-strong';
                text = 'Very Strong';
            }

            return { score: Math.max(0, score), level, text, feedback };
        }

        // Update strength meter
        function updateStrengthMeter(password) {
            const result = calculatePasswordStrength(password);
            const strengthBar = document.getElementById('strengthBar');
            const strengthText = document.getElementById('strengthText');
            const passwordScore = document.getElementById('passwordScore');
            const passwordLength = document.getElementById('passwordLength');

            strengthBar.className = 'strength-bar ' + result.level;
            strengthBar.style.width = result.score + '%';
            strengthText.textContent = result.text;
            passwordScore.textContent = result.score;
            passwordLength.textContent = password.length;

            // Update entropy and crack time
            const entropy = calculateEntropy(password);
            const crackTime = calculateCrackTime(password);
            document.getElementById('entropyValue').textContent = entropy.toFixed(1);
            document.getElementById('crackTime').textContent = crackTime;

            // Update security recommendations
            updateSecurityRecommendations(result, password);
        }

        // Calculate password entropy
        function calculateEntropy(password) {
            let charset = 0;
            if (/[a-z]/.test(password)) charset += 26;
            if (/[A-Z]/.test(password)) charset += 26;
            if (/[0-9]/.test(password)) charset += 10;
            if (/[^A-Za-z0-9]/.test(password)) charset += 32;
            return Math.log2(Math.pow(charset, password.length));
        }

        // Calculate crack time estimation
        function calculateCrackTime(password) {
            const entropy = calculateEntropy(password);
            const combinations = Math.pow(2, entropy);
            const guessesPerSecond = 1000000000; // 1 billion guesses per second
            const seconds = combinations / (2 * guessesPerSecond);

            if (seconds < 60) return seconds.toFixed(0) + 's';
            if (seconds < 3600) return (seconds / 60).toFixed(0) + 'm';
            if (seconds < 86400) return (seconds / 3600).toFixed(0) + 'h';
            if (seconds < 31536000) return (seconds / 86400).toFixed(0) + 'd';
            return (seconds / 31536000).toFixed(0) + 'y';
        }

        // Update security recommendations
        function updateSecurityRecommendations(result, password) {
            const container = document.getElementById('securityRecommendations');
            let recommendations = [];

            if (password.length < 12) recommendations.push('Use at least 12 characters');
            if (!/[A-Z]/.test(password)) recommendations.push('Add uppercase letters');
            if (!/[a-z]/.test(password)) recommendations.push('Add lowercase letters');
            if (!/[0-9]/.test(password)) recommendations.push('Add numbers');
            if (!/[^A-Za-z0-9]/.test(password)) recommendations.push('Add special characters');

            if (recommendations.length === 0) {
                container.innerHTML = '<div class="alert alert-success"><i class="bi bi-check-circle me-2"></i>Password meets security standards!</div>';
            } else {
                const listItems = recommendations.map(rec => `<li>${rec}</li>`).join('');
                container.innerHTML = `<div class="alert alert-warning"><i class="bi bi-exclamation-triangle me-2"></i>Recommendations:<ul class="mb-0 mt-2">${listItems}</ul></div>`;
            }
        }

        // Check requirements
        function checkRequirements(password) {
            const requirements = {
                'req-length': password.length >= 8,
                'req-uppercase': /[A-Z]/.test(password),
                'req-lowercase': /[a-z]/.test(password),
                'req-number': /[0-9]/.test(password),
                'req-special': /[^A-Za-z0-9]/.test(password)
            };

            let metCount = 0;
            Object.keys(requirements).forEach(req => {
                const element = document.getElementById(req);
                const icon = element.querySelector('.requirement-icon');

                if (requirements[req]) {
                    element.className = 'requirement-item requirement-met';
                    icon.className = 'bi bi-check-circle requirement-icon';
                    metCount++;
                } else {
                    element.className = 'requirement-item requirement-unmet';
                    icon.className = 'bi bi-x-circle requirement-icon';
                }
            });

            // Update overall status
            const statusEl = document.getElementById('requirementsStatus');
            const totalReq = Object.keys(requirements).length;

            if (password.length === 0) {
                statusEl.innerHTML = '<i class="bi bi-info-circle"></i><span>Enter a password to check</span>';
                statusEl.parentElement.className = 'requirements-status mt-3 status-info';
            } else if (metCount === totalReq) {
                statusEl.innerHTML = '<i class="bi bi-check-circle"></i><span>All requirements met!</span>';
                statusEl.parentElement.className = 'requirements-status mt-3 status-success';
            } else {
                statusEl.innerHTML = `<i class="bi bi-exclamation-triangle"></i><span>${metCount}/${totalReq} requirements met</span>`;
                statusEl.parentElement.className = 'requirements-status mt-3 status-warning';
            }
        }

        // Password generator
        function generatePassword() {
            const length = parseInt(document.getElementById('passwordLength').value);
            const includeUpper = document.getElementById('includeUppercase').checked;
            const includeLower = document.getElementById('includeLowercase').checked;
            const includeNumbers = document.getElementById('includeNumbers').checked;
            const includeSymbols = document.getElementById('includeSymbols').checked;

            let chars = '';
            if (includeUpper) chars += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            if (includeLower) chars += 'abcdefghijklmnopqrstuvwxyz';
            if (includeNumbers) chars += '0123456789';
            if (includeSymbols) chars += '!@#$%^&*()_+-=[]{}|;:,.<>?';

            if (chars === '') {
                alert('Please select at least one character type');
                return '';
            }

            let password = '';
            for (let i = 0; i < length; i++) {
                password += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return password;
        }

        // Password toggle functionality
        function setupPasswordToggle(inputId, toggleId) {
            const toggle = document.getElementById(toggleId);
            const input = document.getElementById(inputId);

            if (toggle && input) {
                toggle.addEventListener('click', function() {
                    const icon = this.querySelector('i');
                    if (input.type === 'password') {
                        input.type = 'text';
                        icon.className = 'bi bi-eye-slash';
                    } else {
                        input.type = 'password';
                        icon.className = 'bi bi-eye';
                    }
                });
            }
        }

        // Initialize password toggles
        setupPasswordToggle('passwordTest', 'passwordToggle');
        setupPasswordToggle('comparePassword1', 'compareToggle1');
        setupPasswordToggle('comparePassword2', 'compareToggle2');

        // Main password input listener
        document.getElementById('passwordTest').addEventListener('input', function() {
            const password = this.value;
            updateStrengthMeter(password);
            checkRequirements(password);
        });

        // Password generator listeners
        document.getElementById('passwordLength').addEventListener('input', function() {
            document.getElementById('lengthDisplay').textContent = this.value;
        });

        document.getElementById('generatePassword').addEventListener('click', function() {
            const password = generatePassword();
            if (password) {
                document.getElementById('generatedPassword').value = password;
                const result = calculatePasswordStrength(password);
                document.getElementById('generatedStrength').textContent = `Strength: ${result.text} (${result.score}/100)`;
            }
        });

        // Copy to clipboard
        document.getElementById('copyPassword').addEventListener('click', function() {
            const password = document.getElementById('generatedPassword').value;
            if (password) {
                navigator.clipboard.writeText(password).then(() => {
                    const icon = this.querySelector('i');
                    icon.className = 'bi bi-check';
                    setTimeout(() => icon.className = 'bi bi-clipboard', 2000);
                });
            }
        });

        // Password comparison
        function updateComparison() {
            const password1 = document.getElementById('comparePassword1').value;
            const password2 = document.getElementById('comparePassword2').value;
            const result1Element = document.getElementById('compareResult1');
            const result2Element = document.getElementById('compareResult2');

            if (password1) {
                const result1 = calculatePasswordStrength(password1);
                result1Element.querySelector('.strength-indicator').className = 'strength-indicator ' + result1.level;
                result1Element.querySelector('.strength-details').textContent = `${result1.text} (${result1.score}/100)`;
            }

            if (password2) {
                const result2 = calculatePasswordStrength(password2);
                result2Element.querySelector('.strength-indicator').className = 'strength-indicator ' + result2.level;
                result2Element.querySelector('.strength-details').textContent = `${result2.text} (${result2.score}/100)`;
            }

            // Update comparison summary
            if (password1 && password2) {
                const result1 = calculatePasswordStrength(password1);
                const result2 = calculatePasswordStrength(password2);
                const summary = document.getElementById('comparisonSummary');

                if (result1.score > result2.score) {
                    summary.innerHTML = `<div class="alert alert-success"><i class="bi bi-check-circle me-2"></i>Password A is stronger (${result1.score} vs ${result2.score})</div>`;
                } else if (result2.score > result1.score) {
                    summary.innerHTML = `<div class="alert alert-success"><i class="bi bi-check-circle me-2"></i>Password B is stronger (${result2.score} vs ${result1.score})</div>`;
                } else {
                    summary.innerHTML = `<div class="alert alert-warning"><i class="bi bi-info-circle me-2"></i>Both passwords have equal strength (${result1.score})</div>`;
                }
            }
        }

        document.getElementById('comparePassword1').addEventListener('input', updateComparison);
        document.getElementById('comparePassword2').addEventListener('input', updateComparison);

        // Generate initial password
        document.getElementById('generatePassword').click();
    });
</script>