{{> head}}

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

<style>
/* Data Map Styles */
.data-map-card {
    background: white;
    border-radius: 12px;
    padding: 30px;
    margin-bottom: 24px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.map-container {
    height: 400px;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    margin-top: 20px;
}

.map-legend {
    background: white;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    margin-top: 15px;
}

.legend-title {
    font-weight: 600;
    margin-bottom: 10px;
}

.legend-item {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
}

.legend-color {
    width: 24px;
    height: 24px;
    border-radius: 4px;
    margin-right: 10px;
}

.data-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    margin-top: 20px;
}

.stat-card {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    text-align: center;
}

.stat-value {
    font-size: 32px;
    font-weight: 700;
    color: #4361ee;
    margin-bottom: 5px;
}

.stat-label {
    font-size: 14px;
    color: #6b7280;
}

.heatmap-info {
    background: #e0e7ff;
    padding: 15px;
    border-radius: 8px;
    margin-top: 15px;
}
</style>

{{> sidebar}}

<!-- Main Content Wrapper -->
<div class="main-wrapper" id="mainWrapper">
    {{> header}}

    <!-- Main Content -->
    <main class="dashboard-content" id="main-content">
        <div class="container-fluid">
            <!-- Page Header -->
            <div class="mb-4">
                <h1 class="h3 mb-0 text-gray-800">Data Visualization Maps</h1>
                <p class="text-muted">Interactive data maps with visualization layers (100% jQuery-free)</p>
            </div>

            <!-- Student Distribution Map -->
            <div class="data-map-card">
                <h5 class="mb-0">Student Distribution by Location</h5>
                <p class="text-muted small">Interactive map showing student enrollment across regions</p>
                <div id="studentMap" class="map-container"></div>
                <div class="map-legend">
                    <div class="legend-title">Enrollment Levels</div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #10b981;"></div>
                        <span>High (500+ students)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #f59e0b;"></div>
                        <span>Medium (200-500 students)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ef4444;"></div>
                        <span>Low (0-200 students)</span>
                    </div>
                </div>
                <div class="data-stats">
                    <div class="stat-card">
                        <div class="stat-value">2,450</div>
                        <div class="stat-label">Total Students</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">12</div>
                        <div class="stat-label">Locations</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">85%</div>
                        <div class="stat-label">Urban Coverage</div>
                    </div>
                </div>
            </div>

            <!-- Campus Activity Heatmap -->
            <div class="data-map-card">
                <h5 class="mb-0">Campus Activity Heatmap</h5>
                <p class="text-muted small">Real-time visualization of campus foot traffic</p>
                <div id="heatmapMap" class="map-container"></div>
                <div class="heatmap-info">
                    <i class="bi bi-info-circle me-2"></i>
                    <strong>Note:</strong> This heatmap shows simulated activity patterns across campus facilities. Darker areas indicate higher activity levels.
                </div>
            </div>

            <!-- Performance Data Map -->
            <div class="row">
                <div class="col-lg-6">
                    <div class="data-map-card">
                        <h5 class="mb-3">Department Locations</h5>
                        <div id="departmentMap" class="map-container" style="height: 300px;"></div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="data-map-card">
                        <h5 class="mb-3">Research Centers</h5>
                        <div id="researchMap" class="map-container" style="height: 300px;"></div>
                    </div>
                </div>
            </div>

            <!-- Data Insights -->
            <div class="data-map-card">
                <h5 class="mb-3">Data Insights</h5>
                <div class="row">
                    <div class="col-md-3">
                        <div class="text-center">
                            <i class="bi bi-people-fill text-primary" style="font-size: 48px;"></i>
                            <h4 class="mt-3">2,450</h4>
                            <p class="text-muted">Active Students</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="text-center">
                            <i class="bi bi-geo-alt-fill text-success" style="font-size: 48px;"></i>
                            <h4 class="mt-3">12</h4>
                            <p class="text-muted">Campus Locations</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="text-center">
                            <i class="bi bi-building text-warning" style="font-size: 48px;"></i>
                            <h4 class="mt-3">8</h4>
                            <p class="text-muted">Departments</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="text-center">
                            <i class="bi bi-graph-up text-info" style="font-size: 48px;"></i>
                            <h4 class="mt-3">92%</h4>
                            <p class="text-muted">Satisfaction Rate</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    {{> footer}}
</div>

{{> scripts}}

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
// Data Visualization Maps (Vanilla JavaScript)
document.addEventListener('DOMContentLoaded', function() {
    const centerCoords = [37.7749, -122.4194];

    // Student Distribution Map
    const studentMap = L.map('studentMap').setView(centerCoords, 11);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap contributors'
    }).addTo(studentMap);

    // Sample data points for student distribution
    const studentData = [
        { coords: [37.7749, -122.4194], count: 580, name: 'Main Campus' },
        { coords: [37.7849, -122.4094], count: 420, name: 'North Campus' },
        { coords: [37.7649, -122.4294], count: 350, name: 'South Campus' },
        { coords: [37.7949, -122.4394], count: 180, name: 'West Campus' },
        { coords: [37.7549, -122.3994], count: 520, name: 'East Campus' },
        { coords: [37.8049, -122.4194], count: 400, name: 'Extension Center' }
    ];

    studentData.forEach(location => {
        const color = location.count > 500 ? '#10b981' :
                     location.count > 200 ? '#f59e0b' : '#ef4444';

        const circle = L.circle(location.coords, {
            color: color,
            fillColor: color,
            fillOpacity: 0.6,
            radius: location.count * 2
        }).addTo(studentMap);

        circle.bindPopup(`
            <b>${location.name}</b><br>
            Students: ${location.count}<br>
            <small>Click for more details</small>
        `);

        // Add marker
        L.marker(location.coords).addTo(studentMap)
            .bindPopup(`<b>${location.name}</b><br>${location.count} students`);
    });

    // Campus Activity Heatmap
    const heatmapMap = L.map('heatmapMap').setView(centerCoords, 15);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap contributors'
    }).addTo(heatmapMap);

    // Simulate heatmap with circles
    const heatmapData = [
        { coords: [37.7749, -122.4194], intensity: 0.9, name: 'Library' },
        { coords: [37.7759, -122.4184], intensity: 0.7, name: 'Cafeteria' },
        { coords: [37.7739, -122.4204], intensity: 0.8, name: 'Gym' },
        { coords: [37.7769, -122.4174], intensity: 0.6, name: 'Lab Building' },
        { coords: [37.7729, -122.4214], intensity: 0.5, name: 'Student Center' }
    ];

    heatmapData.forEach(point => {
        const opacity = point.intensity;
        const radius = point.intensity * 150;

        L.circle(point.coords, {
            color: '#ef4444',
            fillColor: '#ef4444',
            fillOpacity: opacity * 0.5,
            radius: radius,
            weight: 1
        }).addTo(heatmapMap).bindPopup(`
            <b>${point.name}</b><br>
            Activity Level: ${(point.intensity * 100).toFixed(0)}%
        `);
    });

    // Department Map
    const departmentMap = L.map('departmentMap').setView(centerCoords, 14);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap contributors'
    }).addTo(departmentMap);

    const departments = [
        { coords: [37.7749, -122.4194], name: 'Computer Science', icon: '💻' },
        { coords: [37.7769, -122.4174], name: 'Engineering', icon: '⚙️' },
        { coords: [37.7729, -122.4214], name: 'Business', icon: '💼' },
        { coords: [37.7789, -122.4204], name: 'Arts', icon: '🎨' }
    ];

    departments.forEach(dept => {
        L.marker(dept.coords).addTo(departmentMap)
            .bindPopup(`<b>${dept.icon} ${dept.name}</b>`);
    });

    // Research Centers Map
    const researchMap = L.map('researchMap').setView(centerCoords, 14);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap contributors'
    }).addTo(researchMap);

    const researchCenters = [
        { coords: [37.7759, -122.4184], name: 'AI Research Lab', projects: 12 },
        { coords: [37.7739, -122.4204], name: 'Biotech Center', projects: 8 },
        { coords: [37.7779, -122.4164], name: 'Data Science Hub', projects: 15 }
    ];

    researchCenters.forEach(center => {
        const marker = L.marker(center.coords).addTo(researchMap);
        marker.bindPopup(`
            <b>🔬 ${center.name}</b><br>
            Active Projects: ${center.projects}<br>
            <a href="#" class="text-primary">View Details</a>
        `);

        // Add circle to show research area
        L.circle(center.coords, {
            color: '#4361ee',
            fillColor: '#4361ee',
            fillOpacity: 0.2,
            radius: 200
        }).addTo(researchMap);
    });
});
</script>